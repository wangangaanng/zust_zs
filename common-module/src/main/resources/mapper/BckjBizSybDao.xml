<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zghzbckj.manage.dao.BckjBizSybDao">
    
	<sql id="bckjBizSybColumns">
		a.owid AS "owid",
		a.yh_ref_owid AS "yhRefOwid",
		a.xh AS "xh",
		a.ksh AS "ksh",
		a.xm AS "xm",
		a.xb AS "xb",
		a.sfzh AS "sfzh",
		a.csrq AS "csrq",
		a.syd AS "syd",
		a.mz AS "mz",
		a.zzmm AS "zzmm",
		a.rxnf AS "rxnf",
		a.bynf AS "bynf",
		a.byrq AS "byrq",
		a.cxsy AS "cxsy",
		a.xqda AS "xqda",
		a.sfrx AS "sfrx",
		a.hkpcs AS "hkpcs",
		a.hkrx AS "hkrx",
		a.xlcc AS "xlcc",
		a.xz AS "xz",
		a.ssxx AS "ssxx",
		a.ssxy AS "ssxy",
		a.xxzy AS "xxzy",
		a.zyfx AS "zyfx",
		a.szbj AS "szbj",
		a.pyfs AS "pyfs",
		a.wpdw AS "wpdw",
		a.knslb AS "knslb",
		a.sfslb AS "sfslb",
		a.sjhm AS "sjhm",
		a.dzyx AS "dzyx",
		a.qqhm AS "qqhm",
		a.jtdh AS "jtdh",
		a.jtyb AS "jtyb",
		a.jtdz AS "jtdz",
		a.exp1 AS "exp1",
		a.exp2 AS "exp2",
		a.exp3 AS "exp3",
		a.exp4 AS "exp4",
		a.exp5 AS "exp5",
		a.exp6 AS "exp6",
		a.exp7 AS "exp7",
		a.exp8 AS "exp8",
		a.exp9 AS "exp9",
		a.exp10 AS "exp10",
		a.createtime AS "createtime",
		a.creator AS "creator",
		a.creator_name AS "creatorName",
		a.lastupdate AS "lastupdate",
		a.updator AS "updator",
		a.updator_name AS "updatorName",
		a.ver AS "ver",
		a.vertime AS "vertime",
		a.dept_id AS "deptId",
		a.dept_path AS "deptPath",
		a.delflg AS "delflg",
		a.state AS "state"
	</sql>
	
	<sql id="bckjBizSybJoins">
	</sql>
    
	<select id="get" resultType="com.zghzbckj.manage.entity.BckjBizSyb">
		SELECT 
			<include refid="bckjBizSybColumns"/>
		FROM bckj_biz_syb a
		<include refid="bckjBizSybJoins"/>
		WHERE a.owid = #{owid}
	</select>
	<select id="findByXh" resultType="com.zghzbckj.manage.entity.BckjBizSyb">
		SELECT
		<include refid="bckjBizSybColumns"/>

		FROM bckj_biz_syb a
		<include refid="bckjBizSybJoins"/>
		WHERE a.xh = #{xh}
	</select>
	<select id="findList" resultType="com.zghzbckj.manage.entity.BckjBizSyb">
		SELECT 
			<include refid="bckjBizSybColumns"/>
		FROM bckj_biz_syb a
		<include refid="bckjBizSybJoins"/>
		<where>
			
			<if test="xh != null and xh != ''">
				AND a.xh = #{xh}
			</if>
			<if test="xb != null and xb != ''">
				AND a.xb = #{xb}
			</if>
			<if test="xm != null and xm != ''">
				AND a.xm LIKE concat('%',#{xm},'%')
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
		<select id="findListByMap" resultType="com.zghzbckj.manage.entity.BckjBizSyb">
	        SELECT
			<include refid="bckjBizSybColumns"/>
		FROM bckj_biz_syb a
		<include refid="bckjBizSybJoins"/>
		<where>
			
			<if test="xh != null and xh != ''">
				AND a.xh = #{xh}
			</if>
			<if test="xm != null and xm != ''">
				AND a.xm LIKE concat('%',#{xm},'%')
			</if>
			<if test="xb != null and xb != ''">
				AND a.xb = #{xb}
			</if>
		</where>
		<choose>
			<when test="orderBy != null and orderBy != ''">
				ORDER BY ${orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	<select id="findAllList" resultType="com.zghzbckj.manage.entity.BckjBizSyb">
		SELECT 
			<include refid="bckjBizSybColumns"/>
		FROM bckj_biz_syb a
		<include refid="bckjBizSybJoins"/>
		<where>
			
		</where>		
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	
	<insert id="insert">
		INSERT INTO bckj_biz_syb(
			owid,
			yh_Ref_Owid,
			xh,
			ksh,
			xm,
			xb,
			sfzh,
			csrq,
			syd,
			mz,
			zzmm,
			rxnf,
			bynf,
			byrq,
			cxsy,
			xqda,
			sfrx,
			hkpcs,
			hkrx,
			xlcc,
			xz,
			ssxx,
			ssxy,
			xxzy,
			zyfx,
			szbj,
			pyfs,
			wpdw,
			knslb,
			sfslb,
			sjhm,
			dzyx,
			qqhm,
			jtdh,
			jtyb,
			jtdz,
			exp1,
			exp2,
			exp3,
			exp4,
			exp5,
			exp6,
			exp7,
			exp8,
			exp9,
			exp10,
			createtime,
			creator,
			creator_name,
			lastupdate,
			updator,
			updator_name,
			ver,
			vertime,
			dept_id,
			dept_path,
			delflg,
			state
		) VALUES (
			#{owid},
			#{yhRefOwid},
			#{xh},
			#{ksh},
			#{xm},
			#{xb},
			#{sfzh},
			#{csrq},
			#{syd},
			#{mz},
			#{zzmm},
			#{rxnf},
			#{bynf},
			#{byrq},
			#{cxsy},
			#{xqda},
			#{sfrx},
			#{hkpcs},
			#{hkrx},
			#{xlcc},
			#{xz},
			#{ssxx},
			#{ssxy},
			#{xxzy},
			#{zyfx},
			#{szbj},
			#{pyfs},
			#{wpdw},
			#{knslb},
			#{sfslb},
			#{sjhm},
			#{dzyx},
			#{qqhm},
			#{jtdh},
			#{jtyb},
			#{jtdz},
			#{exp1},
			#{exp2},
			#{exp3},
			#{exp4},
			#{exp5},
			#{exp6},
			#{exp7},
			#{exp8},
			#{exp9},
			#{exp10},
			#{createtime},
			#{creator},
			#{creatorName},
			#{lastupdate},
			#{updator},
			#{updatorName},
			#{ver},
			#{vertime},
			#{deptId},
			#{deptPath},
			#{delflg},
			#{state}
		)
	</insert>
	
	<update id="update">
		UPDATE bckj_biz_syb SET 	
			owid = #{owid},
			yh_Ref_Owid=#{yhRefOwid},
			xh = #{xh},
			ksh = #{ksh},
			xm = #{xm},
			xb = #{xb},
			sfzh = #{sfzh},
			csrq = #{csrq},
			syd = #{syd},
			mz = #{mz},
			zzmm = #{zzmm},
			rxnf = #{rxnf},
			bynf = #{bynf},
			byrq = #{byrq},
			cxsy = #{cxsy},
			xqda = #{xqda},
			sfrx = #{sfrx},
			hkpcs = #{hkpcs},
			hkrx = #{hkrx},
			xlcc = #{xlcc},
			xz = #{xz},
			ssxx = #{ssxx},
			ssxy = #{ssxy},
			xxzy = #{xxzy},
			zyfx = #{zyfx},
			szbj = #{szbj},
			pyfs = #{pyfs},
			wpdw = #{wpdw},
			knslb = #{knslb},
			sfslb = #{sfslb},
			sjhm = #{sjhm},
			dzyx = #{dzyx},
			qqhm = #{qqhm},
			jtdh = #{jtdh},
			jtyb = #{jtyb},
			jtdz = #{jtdz},
			exp1 = #{exp1},
			exp2 = #{exp2},
			exp3 = #{exp3},
			exp4 = #{exp4},
			exp5 = #{exp5},
			exp6 = #{exp6},
			exp7 = #{exp7},
			exp8 = #{exp8},
			exp9 = #{exp9},
			exp10 = #{exp10},
			createtime = #{createtime},
			creator = #{creator},
			creator_name = #{creatorName},
			lastupdate = #{lastupdate},
			updator = #{updator},
			updator_name = #{updatorName},
			ver = #{ver},
			vertime = #{vertime},
			dept_id = #{deptId},
			dept_path = #{deptPath},
			delflg = #{delflg},
			state = #{state}
			<where>
				<if test="owid!=null and owid !=''">
					and owid = #{owid}
				</if>
				<if test="yhRefOwid != null and yhRefOwid!=''">
					and yh_ref_owid = #{yhRefOwid}
				</if>
			</where>
	</update>
	
	<delete id="delete">
		DELETE FROM bckj_biz_syb
		WHERE owid = #{owid}
	</delete>


	<select id="getUserXh" resultType="Map">
		SELECT a.XM ,b.XSXH,a.SJH,a.SFZ,a.XB ,a.MZ,a.CSRQ ,b.XSBJ,b.XSZY,b.XSXY FROM BCKJ_BIZ_YHXX a LEFT JOIN  BCKJ_BIZ_YHKZ b ON a.owid =b.yh_ref_owid WHERE a.owid=#{owid}
	</select>

	<update id="updataInfo" parameterType="BckjBizSyb" >
		 UPDATE bckj_biz_syb SET
			xz = #{xz},
			syd=#{syd},
			bynf=#{bynf},
			jtdh = #{jtdh},
			qqhm=#{qqhm}
		WHERE xh = #{xh}
	</update>

	<update id="updateByXsxh"  parameterType="BckjBizSyb">
		 UPDATE bckj_biz_syb SET
			ksh = #{ksh},
			xh=#{xh},
			zzmm=#{zzmm},
			syd = #{syd},
			jtdz=#{jtdz},
			bynf=#{bynf},
			jtyb=#{jtyb},
			jtdh=#{jtdh},
			xz=#{xz}
		WHERE yh_ref_owid = #{yhRefOwid}
	</update>
	<delete id="deleteByXsxh" parameterType="String">
		DELETE FROM bckj_biz_syb
		<where>
				 xh = #{xsxh}
		</where>
	</delete>

	<update id="updateJyscheme" parameterType="BckjBizSyb">
		UPDATE bckj_biz_syb SET
			bynf=#{bynf},
			xh=#{xh},
			xz=#{xz},
			syd=#{syd},
			jtdh = #{jtdh},
			qqhm=#{qqhm}
		WHERE yh_ref_owid = #{yhRefOwid}
	</update>

	<select id="getSybList" resultType="Map" parameterType="Map">
		select
			a.owid as  owid , b.xsxh as xsxh ,c.ksh as ksh ,a.xb as xb ,
			a.xm as xm , a.sfz as sfz , a.csrq as csrq ,
			c.syd as syd , a.mz as mz ,c.zzmm as zzmm ,c.rxnf  as rxnf ,
			c.bynf as bynf ,c.byrq as byrq , c.cxsy as cxsy , c.xqda as xqda,
			c.SFRX as sfrx , c.HKPCS as hkpcs , c.HKRX as hkrx , c.XLCC as xlcc ,
			c.XZ as xz ,d.xxmc as xxmc, b.xsxy as xsxy ,b.xszy as xszy, c.zyfx as zyfx , c.szbj as szbj,
			c.pyfs as pyfs , c.wpdw as wpdw , c.KNSLB  as knslb , c.SFSLB as sfslb,
			a.sjh as sjh , a.yx as yx ,c.QQHM as qqhm , c.JTDH as jtdh ,c.JTYB as jtyb,
			c.JTDZ as jtdz,c.exp1 as exp1
		from bckj_biz_yhxx a ,bckj_biz_yhkz b ,bckj_biz_syb c,bckj_biz_jyscheme d
		<where>
			a.owid = b.yh_ref_owid and b.xsxh = c.xh and b.xsxh = d.xsxh
			<if test="xm!=null and xm!=''">
				and  a.xm like CONCAT('%',#{xm},'%')
			</if>
			<if test="zyfx!=null and zyfx!=''">
				and  c.zyfx like CONCAT('%',#{zyfx},'%')
			</if>
			<if test="knslb!=null and knslb!=''">
				and  c.knslb like CONCAT('%',#{knslb},'%')
			</if>
			<if test="pyfs!=null and pyfs!=''">
				and  c.pyfs like CONCAT('%',#{pyfs},'%')
			</if>
			<if test="cxsy!=null and cxsy!=''">
				and  c.cxsy like CONCAT('%',#{cxsy},'%')
			</if>
			<if test="xz!=null and xz!=''">
				and  c.xz like CONCAT('%',#{xz},'%')
			</if>
			<if test="xlcc!=null and xlcc!=''">
				and  c.xlcc like CONCAT('%',#{xlcc},'%')
			</if>
			<if test="xsxh!=null and xsxh!=''">
				and  b.xsxh like CONCAT('%',#{xsxh},'%')
			</if>
			<if test="szbj!=null and szbj!=''">
				and  c.szbj like CONCAT('%',#{szbj},'%')
			</if>
			<if test="xsxy!=null and xsxy!=''">
				and  b.xsxy like CONCAT('%',#{xsxy},'%')
			</if>

			<if test="sjh!=null and sjh!=''">
				and  a.sjh like CONCAT('%',#{sjh},'%')
			</if>
			<if test="zzmm!=null and zzmm!=''">
				and  c.zzmm like CONCAT('%',#{zzmm},'%')
			</if>
			<if test="sfrx!=null and sfrx!=''">
				and  c.sfrx like CONCAT('%',#{sfrx},'%')
			</if>
			<if test="ksh!=null and ksh!=''">
				and  c.ksh like CONCAT('%',#{ksh},'%')
			</if>
			<if test="sfz!=null and sfz!=''">
				and  a.sfz like CONCAT('%',#{sfz},'%')
			</if>
			<if test="mz!=null and mz!=''">
				and  a.mz like CONCAT('%',#{mz},'%')
			</if>
			<if test="syd!=null and syd!=''">
				and  c.syd like CONCAT('%',#{syd},'%')
			</if>
		</where>
			order  by xsxh asc
	</select>


	<select id="getOne" parameterType="Map" resultType="Map">
		select
			a.owid as  owid , b.xsxh as xsxh ,c.ksh as ksh ,a.xb as xb ,
			a.xm as xm , a.sfz as sfz , a.csrq as csrq ,
			c.syd as syd , a.mz as mz ,c.zzmm as zzmm ,c.rxnf  as rxnf ,
			c.bynf as bynf ,c.byrq as byrq , c.cxsy as cxsy , c.xqda as xqda,
			c.SFRX as sfrx , c.HKPCS as hkpcs , c.HKRX as hkrx , c.XLCC as xlcc ,
			c.XZ as xz ,d.xxmc as xxmc, b.xsxy as xsxy ,b.xszy as xszy, c.zyfx as zyfx , c.szbj as szbj,
			c.pyfs as pyfs , c.wpdw as wpdw , c.KNSLB  as knslb , c.SFSLB as sfslb,
			a.sjh as sjh , a.yx as yx ,c.QQHM as qqhm , c.JTDH as jtdh ,c.JTYB as jtyb,
			c.JTDZ as jtdz
		from bckj_biz_yhxx a ,bckj_biz_yhkz b ,bckj_biz_syb c,bckj_biz_jyscheme d
		where a.owid = b.yh_ref_owid and b.xsxh = c.xh and b.xsxh = d.xsxh and a.owid=#{owid}
	</select>


	<select id="getBynfByXsxh" parameterType="Map" resultType="Map">
		select bynf from  bckj_biz_syb
		where xh=#{xsxh}
	</select>



</mapper>